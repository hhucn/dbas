<!DOCTYPE html>
<tal:block metal:use-macro="layout" i18n:domain="dbas" metal:define-macro="layout">
	<tal:block metal:fill-slot="content_page">

		<head>
			<link type="text/css" href="${request.static_url('dbas:static/css/theme_basetemplate.css')}" rel="stylesheet">
			<link type="text/css" href="${request.static_url('dbas:static/css/theme_content.css')}" rel="stylesheet">
		</head>

		<div class="container colored_container" id="header-container">
			<div class="row">
				<div class="col-md-8 center">
					<span i18n:translate="current_discussion">Current discussion is about</span>:<br>
					<span class="lead" id="issue_info">${structure:issues.info}</span>
				</div>
				<div class="col-md-1 center text-center">
                    <img class="icon-badge" style="width: 30px;" src="${request.static_url('dbas:static/images/icon_info.png')}" data-toggle="tooltip" data-placement="auto" tal:attributes="data-original-title issues.tooltip"/>
                </div>
				<div class="col-md-2 center text-center">
					<div class="dropdown center">
						<button class="btn btn-primary dropdown-toggle btn-sm" type="button" id="issue-dropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true" tal:attributes="issue issues.uid">
							<span i18n:translate="switch_topc">Switch Topic</span>&#160;&#160;<span class="caret"></span>
						</button>
						<ul class="dropdown-menu" id="dropdown-issue-list" aria-labelledby="issue-dropdown" style="width: 250px;">
							<li class="dropdown-header" i18n:translate="topics">Topics</li>
							<li tal:repeat="issue issues.all" tal:attributes="class issue.enabled">
								<a href="#" tal:attributes="href issue.url; value issue.title"><span tal:replace="issue.title"></span><span class="badge" style="float: right; margin-left: 1em"><span tal:replace="issue.arg_count"></span></span></a>
							</li>
						</ul>
					</div>
                 </div>
                <div class="col-md-1 center text-center">
					<button id="discussion-restart-btn" class="btn btn-primary btn-sm" data-dismiss="modal" type="button" onclick="" tal:attributes="onclick extras.restart_url">
						<span i18n:translate="restart_discussion">Restart</span>&#160;&#160;<span class="glyphicon glyphicon-refresh" aria-hidden="true"></span>
					</button>
				</div>
			</div>
		</div>

		<div class="container colored_container" id="discussion-container">
			<input type="hidden" id="hidden_csrf_token" name="csrf_token" value="${request.session.get_csrf_token()}">
			<div class="row">
				<div class="col-md-11" style="text-align: justify;">

					<div id="discussion-error-description-space" class="alert alert-danger alert-dismissible" style="display: none;">
						<button type="button" class="close" data-dismiss="alert" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
						<span id="discussion-error-description"></span>
					</div>

					<div id="discussion-success-description-space" class="alert alert-success alert-dismissible" style="display: none;">
						<button type="button" class="close" data-dismiss="alert" aria-label="Close">
							<span aria-hidden="true">&times;</span>
						</button>
						<strong i18n:translate="success">Success</strong>
						<span id="discussion-success-description"></span>
					</div>

					 <div id="dialog-speech-bubbles-space">
                         <div tal:repeat="bubble discussion.bubbles" tal:omit-tag="">
                             <div tal:condition="bubble.is_user" class="line-wrapper-r">
                                 <a tal:omit-tag="bubble.omit_url" tal:attributes="href bubble.url; title extras.buttons.go_back" data-toggle="tooltip" data-placement="bottom">
                                     <p class="triangle-r" tal:attributes="id bubble.id">${structure:bubble.message}</p>
                                 </a>
                             </div>
                             <div tal:condition="bubble.is_system" class="line-wrapper-l">
                                 <a tal:omit-tag="bubble.omit_url" tal:attributes="href bubble.url; title extras.buttons.go_back" data-toggle="tooltip" data-placement="bottom">
                                     <p class="triangle-l" tal:attributes="id bubble.id">${structure:bubble.message}</p>
                                 </a>
                             </div>
                             <div tal:condition="bubble.is_status" class="line-wrapper-m">
                                 <p class="triangle-m" tal:attributes="id bubble.id">${structure:bubble.message}</p>
                             </div>
                        </div>
                     </div>
					<div id="discussions-space">

						<ul id="discussions-space-list">
							<li tal:repeat="item items">
								<input id="tmp" type="radio" name="discussion-button-group" onclick="" tal:attributes="id item.id; onclick item.url">
								<span tal:repeat="premise item.premises" tal:omit-tag=""><label for="tmp" tal:attributes="for item.id; id premise.id">${structure:premise.title}</label><label tal:attributes="for item.id" tal:condition="not:repeat.premise.end">&nbsp;<em i18n:translate="and">and</em></label></span>
							</li>
						</ul>

					</div>
				</div>

				<div class="col-md-1">
					<ul id="discussion-sidebar">
                        <li>
						    <a id="share-url" data-toggle="tooltip" data-placement="bottom" title="Share your url" tal:attributes="title extras.buttons.share_url"><img class="icon-badge" src="${request.static_url('dbas:static/images/icon_share.png')}"/></a>
                        </li>
						<li tal:condition="extras.is_editable">
							<img id="edit-statement" class="icon-badge" alt="icon-pencil" src="${request.static_url('dbas:static/images/icon_pencil.png')}" data-toggle="tooltip" data-placement="left" tal:attributes="title extras.buttons.edit_statement; value extras.buttons.edit_statement" />
						</li>
						<li tal:condition="extras.is_reportable" >
							<img id="report-button" class="icon-badge" alt="icon-report" src="${request.static_url('dbas:static/images/icon_report.png')}" data-toggle="tooltip" data-placement="left" tal:attributes="value extras.buttons.report; title extras.buttons.report_title" />
						</li>
						<li>
							<img tal:condition="extras.is_questionable" id="question-button" class="icon-badge" alt="icon-report" src="${request.static_url('dbas:static/images/icon_questionmark1.png')}" data-toggle="tooltip" data-placement="left" tal:attributes="title extras.buttons.question_title" />
						</li>
						<li>
							<div id="discussion-sidebar-style-menu" tal:condition="extras.show_display_style or extras.show_bar_icon or extras.show_expert_icon">
								<img id="more-statement" class="icon-badge" src="${request.static_url('dbas:static/images/icon_simple.png')}" title="" data-popover="true" data-html="true" data-placement="left" tal:attributes="title extras.buttons.more_title"/>

								<ul id="site-navigation">
									<li>
										<img tal:condition="extras.show_bar_icon" id="opinion-barometer-img" class="display-style-menu-icon icon-badge" alt="icon-bars" data-toggle="tooltip" data-placement="left" tal:attributes="title extras.title.barometer" src="${request.static_url('dbas:static/images/icon_bars.png')}" title="" />
									</li>

									<li>
										<img tal:condition="extras.show_display_style" id="display-style-icon-guided-img" class="display-style-menu-icon icon-badge" alt="icon-guided" data-toggle="tooltip" data-placement="left" tal:attributes="title extras.title.guided_view" src="${request.static_url('dbas:static/images/icon_guided.png')}" title="" />
									</li>

									<li>
										<img tal:condition="extras.show_display_style" id="display-style-icon-island-img" class="display-style-menu-icon icon-badge" alt="icon-island" data-toggle="tooltip" data-placement="left" tal:attributes="title extras.title.island_view" src="${request.static_url('dbas:static/images/icon_island.png')}" title="" />
									</li>

									<li>
										<img tal:condition="extras.show_expert_icon" id="display-style-icon-expert-img" class="display-style-menu-icon icon-badge" alt="icon-expert" data-toggle="tooltip" data-placement="left" tal:attributes="title extras.title.expert_view" src="${request.static_url('dbas:static/images/icon_expert.png')}" title="" />
									</li>
								</ul>
							</div>
						</li>
					</ul>
				</div>
			</div>

			<div class="row" id="discussion-failure-row" style="display:none">
				<div class="col-md-3"></div>
				<div class="col-md-6">
					<button type="button" class="close" data-dismiss="modal" aria-label="Close" onclick="$(this).parent().hide();">
						<span aria-hidden="true" style="color: white;">&times;</span>
					</button>
					<div class="alert alert-danger" role="alert">
						<span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
						<span i18n:translate="error">Error:</span>
						<span id="discussion-failure-msg"></span>
					</div>
					<div class="col-md-3"></div>
				</div>
			</div>
		</div>

		<div class="container colored_container" id="island-view-container" style="display:none" tal:condition="extras.show_display_style">
			<button id="close-island-view-container" type="button" class="close" data-dismiss="modal" aria-label="Close">
				<span aria-hidden="true">&times;</span>
			</button>
			<div class="row" id="island-view-container-space">
				<div class="col-md-12 text-center">
					<h4><span i18n:translate="island_view_for">Island View for</span> <span id="island-view-container-space-heading"><strong>${structure:extras.island.heading}</strong></span></h4>
				</div>
			</div>

			<div class="row">
				<div class="col-md-6">
					<div class="panel panel-default">
						<div class="panel-heading">
							<h5>
									<span class="text-danger">✗</span>
									<span tal:replace="structure:extras.island.undermine_text">structure:undermine_text</span>
								</h5>
						</div>
						<div class="panel-body">
							<ul>
								<li tal:repeat="undermine extras.island.undermine" tal:attributes="id undermine.id">
									<label tal:attributes="for undermine.id">${structure:undermine.text}</label>
								</li>
							</ul>
						</div>
					</div>
				</div>
				<div class="col-md-6">
					<div class="panel panel-default">
						<div class="panel-heading">
							<h5>
									<span class="text-success">✓</span> 
									<span tal:replace="extras.island.support_text">structure:support_text</span>
								</h5>
						</div>
						<div class="panel-body">
							<ul>
								<li tal:repeat="support extras.island.support" tal:attributes="id support.id">
									<label tal:attributes="for support.id">${structure:support.text}</label>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>

			<div class="row">
				<div class="col-md-6">
					<div class="panel panel-default">
						<div class="panel-heading">
							<h5>
                                    <span class="text-danger">✗</span>
                                    <span tal:replace="extras.island.undercut_text">structure:undercut_text</span>
							    </h5>
						</div>
						<div class="panel-body">
							<ul>
								<li tal:repeat="undercut extras.island.undercut" tal:attributes="id undercut.id">
									<label tal:attributes="for undercut.id">${structure:undercut.text}</label>
								</li>
							</ul>
						</div>
					</div>
				</div>

				<div class="col-md-6">
					<div class="panel panel-default">
						<div class="panel-heading">
							<h5>
                                <span class="text-danger">✗</span>
                                <span tal:replace="extras.island.rebut_text">structure:rebut_text</span>
								</h5>
						</div>
						<div class="panel-body">
							<ul>
								<li tal:repeat="rebut extras.island.rebut" tal:attributes="id rebut.id">
									<label tal:attributes="for rebut.id">${structure:rebut.text}</label>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>

<!--?				<div class="col-md-6">
					<div class="panel panel-default">
						<div class="panel-heading">
							<h5>
									<span class="text-success">✓</span>
									<span tal:replace="extras.island.overbid_text">overbid_text</span>
								</h5>
						</div>
						<div class="panel-body">
							<ul>
								<li tal:repeat="overbid extras.island.overbid" tal:attributes="id overbid.id">
									<label tal:attributes="for overbid.id">${structure:overbid.text}</label>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>

			<div class="row">
				<div class="col-md-12">
					<div class="panel panel-default">
						<div class="panel-heading">
							<h5>
									<span class="text-danger">✗</span>
									<span tal:replace="extras.island.rebut_text">rebut_text</span>
								</h5>
						</div>
						<div class="panel-body">
							<ul>
								<li tal:repeat="rebut extras.island.rebut" tal:attributes="id rebut.id">
									<label tal:attributes="for rebut.id">${structure:rebut.text}</label>
								</li>
							</ul>
						</div>
					</div>
				</div>
			</div>-->

			<div class="center text-center">
				<button id="island-view-add-arguments" type="button" class="button button-block btn btn-primary disabled" data-dismiss="modal">
					<span i18n:translate="add_statement">Add statement</span>
				</button>
			</div>

		</div>

		<div class="colored_container" id="graph-view-container" style="display:none">
			<button id="close-graph-view-container" type="button" class="close" data-dismiss="modal" aria-label="Close">
				<span aria-hidden="true">&times;</span>
			</button>
			<h4 id="graph-view-container-header" class="center"></h4>
			<div id="graph-view-container-space"></div>
		</div>

		<div class="container colored_container" id="add-statement-container" style="display:none" tal:attributes="style extras.add_statement_container_style">
			<button tal:condition="extras.close_statement_container" id="close-statement-container" type="button" class="close" data-dismiss="modal" aria-label="Close">
				<span aria-hidden="true">&times;</span>
			</button>
			<div class="col-md-12 text-center">
				<h5><span i18n:translate="what_is_your_idea">What is your idea? What should we do?</span></h5>
				<div id="add-statement-error-container" class="alert alert-danger" role="alert" style="display:none">
					<button type="button" class="close" data-dismiss="alert" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
					<span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
					<span i18n:translate="error:">Error:</span>
					<span id="add-statement-error-msg"></span>
				</div>
				<div id="add-statement-container-body">
					<input id="add-statement-container-main-input" type="text" class="add-statement-container-input form-control" name="" autocomplete="off" placeholder="example: We should build a new opera house" value="" />
				</div>
				<div class="list-group" id="proposal-statement-list-group"></div>
				<input id="send-new-statement" type="button" name="" value="Save my Statement!" class="button button-block btn-lg btn btn-primary" data-dismiss="modal" data-toggle="tooltip" data-placement="bottom" title="Saving the data." tal:attributes="value extras.buttons.save_my_statement; name discussion.mode"/>
			</div>
		</div>

		<div class="container colored_container" id="add-premise-container" style="display:none" tal:attributes="style extras.add_premise_container_style">
			<button tal:condition="extras.close_premise_container" id="close-premise-container" type="button" class="close" data-dismiss="modal" aria-label="Close">
				<span aria-hidden="true">&times;</span>
			</button>
			<div class="col-md-12 text-center">
				<h5 i18n:translate="let_me_enter_my_reason">Let me enter my reason!</h5>
				<p class="lead" id="add-premise-container-main-input-intro">${structure:discussion.add_premise_text}</p>
				<div id="add-premise-error-container" class="alert alert-danger" role="alert" style="display:none">
					<button type="button" class="close" data-dismiss="alert" aria-label="Close">
						<span aria-hidden="true">&times;</span>
					</button>
					<span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
					<span i18n:translate="error:">Error:</span>
					<span id="add-premise-error-msg"></span>
				</div>
				<div id="add-premise-container-body">
					<div class="container-three-divs" style="padding-bottom: 2em;">
						<div>
							<h5 style="float: left; line-height: 20px; text-align: center;" i18n:translate="Because...">Because...</h5>
						</div>
						<div class="flex-div">
							<input id="add-premise-container-main-input" type="text" class="add-preise-container-input form-control" name="" autocomplete="off" placeholder="example: There is some reason!" value="">
						</div>
						<div>
							<img class="icon-badge icon-rem-premise"
								 alt="icon-rem"
								 src="${request.static_url('dbas:static/images/icon_minus2.png')}"
								 style="height: 30px; display:none; padding-right: 0.5em;"
								 tal:attributes="title extras.buttons.rem_statement_row_title"/>
							<img class="icon-badge icon-add-premise"
								 alt="icon-add"
								 src="${request.static_url('dbas:static/images/icon_plus2.png')}"
								 style="height: 30px;"
								 tal:attributes="title extras.buttons.add_statement_row_title"/>
						</div>
					</div>
				</div>
				<div class="list-group" id="proposal-premise-list-group"></div>
				<input id="send-new-premise" type="button" name="" value="Save my Statement!" class="button button-block btn-lg btn btn-primary" data-dismiss="modal" data-toggle="tooltip" data-placement="bottom" title="Saving the data." tal:attributes="value extras.buttons.save_my_statement; name discussion.mode"/>
			</div>
		</div>

		<div class="container colored_container" id="display-control-container" tal:condition="extras.show_display_style" style="display:none">
			<div class="row">
				<h4 i18n:translate="change_style">Change display style</h4>
				<div class="col-md-4">
					<input type="radio" id="sc-style-1" checked value="Dialog View">
					<label id="label-sc-style-1" for="sc-style-1" data-value="Dialog View" i18n:translate="dialog_view">Dialog View </label>
					<br>
					<img id="display-control-container-icon-guided" class="icon-badge" alt="icon-guided" src="${request.static_url('dbas:static/images/icon_guided.png')}" />
				</div>
				<div class="col-md-4">
					<input type="radio" id="sc-style-2" value="Island View">
					<label id="label-sc-style-2" for="sc-style-2" data-value="Island View" i18n:translate="island_view">Island View</label>
					<br>
					<img id="display-control-container-icon-island" class="icon-badge" alt="icon-island" src="${request.static_url('dbas:static/images/icon_island.png')}" />
				</div>
				<div class="col-md-4">
					<input type="radio" id="sc-style-3" value="Complete View">
					<label id="label-sc-style-3" for="sc-style-3" data-value="Complete View" i18n:translate="complete_view">Complete View</label>
					<br>
					<img id="display-control-container-icon-expert" class="icon-badge" alt="icon-expert" src="${request.static_url('dbas:static/images/icon_expert.png')}" />
				</div>
			</div>
		</div>


		<script type="text/javascript" src="${request.static_url('dbas:static/js/discussion-guihandler.js')}"></script>
		<script type="text/javascript" src="${request.static_url('dbas:static/js/discussion-interactionhandler.js')}"></script>
		<script type="text/javascript" src="${request.static_url('dbas:static/js/discussion-ajaxhandler.js')}"></script>
		<script type="text/javascript" src="${request.static_url('dbas:static/js/discussion-helper.js')}"></script>
		<script type="text/javascript" src="${request.static_url('dbas:static/js/discussion-main.js')}"></script>

		<script type="text/javascript" src="${request.static_url('dbas:static/js/discussion-graph.js')}"></script>
		<script type="text/javascript" src="${request.static_url('dbas:static/js/discussion-barometer.js')}"></script>

	</tal:block>
</tal:block>